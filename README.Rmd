---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# `climecol`

<!-- badges: start -->
[![R-CMD-check](https://github.com/jbaafi/climecol/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/jbaafi/climecol/actions/workflows/R-CMD-check.yaml)
[![pkgdown](https://img.shields.io/badge/docs-pkgdown-blue)](https://jbaafi.github.io/climecol/)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
<!-- badges: end -->


## Overview

`climecol` provides tools for archiving, cleaning, analyzing, and visualizing weather and climate data for ecological and infectious-disease modeling.
It ships curated daily weather data and simple helpers for quick plotting and analysis.


## Installation

You can install the development version of `climecol` from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("jbaafi/climecol")
```

(Alternatively: `pak::pak("jbaafi/climecol")`.)

## Data Importation

```{r, eval=FALSE}
library(climecol)
wx <- read_weather_csv("/Users/jbaafi/Desktop/data.csv")
qa <- validate_weather(wx, temp_bounds = c(-50, 50), rain_max = 150, snow_max = 60)
qa$summary

```

## Gap handling and imputation

The package provides tools to handle gaps in weather records:

- **`complete_daily_calendar()`** ensures a full daily date sequence per station, making gaps explicit.  
- **`summarise_gaps()`** quantifies missingness, coverage, and longest contiguous gaps.  
- **`impute_weather()`** offers lightweight fillers (last observation carried forward, linear, or spline).  

Together, these helpers make it easy to prepare consistent daily time series for downstream climate-driven modeling.


## Photoperiod (daylength)

The package includes fast, dependency-free photoperiod helpers based on a standard solar-geometry approximation (Forsythe et al., 1995). These return **hours of daylight** from date and latitude only—ideal as a smooth seasonal driver for ecological models.

### Functions

- `daylength_f95(date, lat)` → numeric vector of daylight hours

- `photoperiod_year(year, lat = NULL, location = NULL, aggregate = c("none","month"))`  
  - Supply either `lat` **or** a built-in `location` key  
  - `aggregate = "month"` returns monthly means (12 rows)

- `photoperiod_sites()` → named vector of built-in locations and latitudes  
  *(keys are matched case-insensitively; punctuation/spacing ignored)*

Quick examples

```{r}
library(climecol)

# Daily photoperiod for 2024 at St. John's (NL) via location
pp_nl <- photoperiod_year(2024, location = "St John's")
head(pp_nl)

# Monthly mean photoperiod at 47.56°N
photoperiod_year(2024, lat = 47.56, aggregate = "month")

# Saint John (NB) vs St. John's (NL) — distinct cities
photoperiod_year(2024, location = "Saint John", aggregate = "month")
photoperiod_year(2024, location = "St John's", aggregate = "month")

# List built-in sites
photoperiod_sites()

```

A simple plot of daylength over the year:

```{r}
plot(pp_nl$date, pp_nl$daylength_hours, type = "l",
     xlab = "Date", ylab = "Daylength (hours)",
     main = "Photoperiod at St. John's, NL (2024)")

```

### Notes

- Inputs like `"St John's"`, `"st_johns"`, and `"St.Johns"` all resolve to the same NL site (`st_johns`).
- `"Saint John"` / `"st john"` resolves to NB (`saint_john`).
- If you pass `lat` (no `location`), the output is labeled as `lat_<value>`.


## Example

Load the package and explore the included Newfoundland dataset (2008–2023):

```{r example}
library(climecol)

# Load dataset
data(weather_nl)

# Peek at structure
dplyr::glimpse(weather_nl)

```

Plot daily rainfall:

```{r rainfall-plot, message=FALSE, warning=FALSE}
plot_rainfall(weather_nl)
```

> This figure was generated when knitting this README.  

## Contributing

Issues and pull requests are welcome via the repo’s [issue tracker](https://github.com/jbaafi/climecol/issues).

## Contact

If you’re interested in discussing collaborations or have questions about `climecol`, email me at [jbaafi@mun.ca](mailto:jbaafi@mun.ca).

## License

MIT © Joseph Baafi

