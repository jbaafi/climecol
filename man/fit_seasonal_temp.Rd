% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_seasonal_temp.R
\name{fit_seasonal_temp}
\alias{fit_seasonal_temp}
\title{Fit seasonal temperature curve}
\usage{
fit_seasonal_temp(df, funcs = c("sin1", "sin2"), plot = FALSE)
}
\arguments{
\item{df}{A data frame with column \code{date} and either \code{tavg_c} or both \code{tmin_c} and \code{tmax_c}.}

\item{funcs}{Character vector of models to fit. Options are:
\itemize{
\item "sin1": \eqn{a + b_1 \sin(2\pi t / 365) + b_2 \cos(2\pi t / 365)}
\item "sin2": \eqn{T_0 \left(1 + T_1 \cos(2\pi(\omega t + \theta)/365)\right)}
}}

\item{plot}{Logical; if TRUE, include a ggplot overlay of observed vs. fitted curves.}
}
\value{
A list with:
\describe{
\item{daily_avg}{tibble of day-of-year (\code{day_of_year}), observed \code{mean_temp}, and fitted columns.}
\item{fits}{list of \code{nls} fit objects for each model.}
\item{metrics}{tibble with \code{model}, \code{AIC}, and \code{R2} per fit.}
\item{plot}{ggplot object (present when \code{plot = TRUE}).}
}
}
\description{
Fits sinusoidal/periodic models to the mean daily temperature cycle (averaged across years).
Returns fitted objects, AIC and R^2 metrics, and an optional plot overlay.
}
\details{
The function aggregates input to daily means by day-of-year across all years,
then fits each requested model with \code{nls}. R^2 is computed as 1 - SS_res/SS_tot
on the aggregated series.
}
\examples{
data(weather_nl)
res <- fit_seasonal_temp(weather_nl, funcs = c("sin1","sin2"), plot = TRUE)
res$metrics
if (!is.null(res$plot)) print(res$plot)

}
